{"version":3,"sources":["goods_detail.js"],"names":["$","GoodsObj","init","goodsDate","eventList","ajax","type","url","data","goods_id","getUrl","success","result","meta","status","cat_id","goods_name","goods_number","goods_price","goods_small_logo","goods_weight","htmls","template","html","gallery","mui","slider","interval","console","log","on","userStr","sessionStorage","getItem","toast","setTimeout","setItem","location","href","token","JSON","parse","info","stringify","headers","Authorization","confirm","editType","index","msg","goodsDatail","get","name","reg","RegExp","r","window","search","substr","match","decodeURI"],"mappings":";;AAEAA,CAAC,CAAC,YAAY;AACV,MAAIC,QAAQ,GAAC,EAAb;AACAC,EAAAA,IAAI;;AACJ,WAASA,IAAT,GAAe;AACbC,IAAAA,SAAS;AACTC,IAAAA,SAAS;AACV;;AAGD,WAASD,SAAT,GAAqB;AACjBH,IAAAA,CAAC,CAACK,IAAF,CAAO;AACHC,MAAAA,IAAI,EAAE,KADH;AAEHC,MAAAA,GAAG,EAAE,oDAFF;AAGH;AACAC,MAAAA,IAAI,EAAC;AAACC,QAAAA,QAAQ,EAACC,MAAM,CAAC,UAAD;AAAhB,OAJF;AAKHC,MAAAA,OAAO,EAAE,iBAAUC,MAAV,EAAkB;AACvB,YAAIA,MAAM,CAACC,IAAP,CAAYC,MAAZ,IAAsB,GAA1B,EAA+B;AAC3B;AACAb,UAAAA,QAAQ,GAAC;AACLc,YAAAA,MAAM,EAACH,MAAM,CAACJ,IAAP,CAAYO,MADd;AAELN,YAAAA,QAAQ,EAACG,MAAM,CAACJ,IAAP,CAAYC,QAFhB;AAGLO,YAAAA,UAAU,EAACJ,MAAM,CAACJ,IAAP,CAAYQ,UAHlB;AAILC,YAAAA,YAAY,EAACL,MAAM,CAACJ,IAAP,CAAYS,YAJpB;AAKLC,YAAAA,WAAW,EAACN,MAAM,CAACJ,IAAP,CAAYU,WALnB;AAMLC,YAAAA,gBAAgB,EAACP,MAAM,CAACJ,IAAP,CAAYW,gBANxB;AAOLC,YAAAA,YAAY,EAACR,MAAM,CAACJ,IAAP,CAAYY;AAPpB,WAAT,CAF2B,CAW3B;;AACA,cAAIZ,IAAI,GAAGI,MAAM,CAACJ,IAAlB;AACA,cAAIa,KAAK,GAACC,QAAQ,CAAC,MAAD,EAAQd,IAAR,CAAlB;AACAR,UAAAA,CAAC,CAAC,WAAD,CAAD,CAAeuB,IAAf,CAAoBF,KAApB,EAd2B,CAiB3B;;AACA,cAAIG,OAAO,GAAGC,GAAG,CAAC,aAAD,CAAjB;AACAD,UAAAA,OAAO,CAACE,MAAR,CAAe;AACXC,YAAAA,QAAQ,EAAE,IADC,CACI;;AADJ,WAAf;AAGH,SAtBD,MAsBO;AACHC,UAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACH;AAGJ;AAjCE,KAAP;AAsCH;;AAGD,WAASzB,SAAT,GAAqB;AACjB;AACAJ,IAAAA,CAAC,CAAC,oBAAD,CAAD,CAAwB8B,EAAxB,CAA2B,KAA3B,EAAiC,YAAY;AACzC,UAAIC,OAAO,GAAGC,cAAc,CAACC,OAAf,CAAuB,UAAvB,CAAd;;AACA,UAAG,CAACF,OAAJ,EAAY;AACd;AACEN,QAAAA,GAAG,CAACS,KAAJ,CAAU,QAAV;AACAC,QAAAA,UAAU,CAAC,YAAI;AACXH,UAAAA,cAAc,CAACI,OAAf,CAAuB,SAAvB,EAAiCC,QAAQ,CAACC,IAA1C;AACAD,UAAAA,QAAQ,CAACC,IAAT,GAAc,YAAd;AACH,SAHS,EAGR,IAHQ,CAAV;AAIC,OAPD,MAOK;AACD,YAAIC,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWV,OAAX,EAAoBQ,KAAhC;AACAvC,QAAAA,CAAC,CAACK,IAAF,CAAO;AACHE,UAAAA,GAAG,EAAE,mDADF;AAEHD,UAAAA,IAAI,EAAC,MAFF;AAGHE,UAAAA,IAAI,EAAC;AACDkC,YAAAA,IAAI,EAACF,IAAI,CAACG,SAAL,CAAe1C,QAAf;AADJ,WAHF;AAMH2C,UAAAA,OAAO,EAAC;AACJC,YAAAA,aAAa,EAAEN;AADX,WANL;AASH5B,UAAAA,OAAO,EAAC,iBAASC,MAAT,EAAgB;AACpB,gBAAGA,MAAM,CAACC,IAAP,CAAYC,MAAZ,IAAoB,GAAvB,EAA2B;AACvBW,cAAAA,GAAG,CAACqB,OAAJ,CAAY,aAAZ,EAA0B,MAA1B,EAAiC,CAAC,IAAD,EAAM,IAAN,CAAjC,EAA6C,UAASC,QAAT,EAAkB;AAC3D,oBAAGA,QAAQ,CAACC,KAAT,IAAgB,CAAnB,EAAqB;AACjBX,kBAAAA,QAAQ,CAACC,IAAT,GAAc,WAAd;AACH,iBAFD,MAEM,IAAGS,QAAQ,IAAE,CAAb,EAAe;AACjBnB,kBAAAA,OAAO,CAACC,GAAR,CAAY,IAAZ;AACH;AACJ,eAND;AAOH,aARD,MAQK;AACDJ,cAAAA,GAAG,CAACS,KAAJ,CAAUtB,MAAM,CAACC,IAAP,CAAYoC,GAAtB;AACH;AACJ;AArBE,SAAP;AAuBH;AAEJ,KApCD;AAsCD;;AACD,WAASC,WAAT,GAAsB;AAClBlD,IAAAA,CAAC,CAACmD,GAAF,CACE,oDADF,EAEE;AACI1C,MAAAA,QAAQ,EAACC,MAAM,CAAC,UAAD;AADnB,KAFF,EAKE,UAASE,MAAT,EAAgB;AACZ,UAAGA,MAAM,CAACC,IAAP,CAAYoC,GAAZ,IAAiB,GAApB,EAAwB;AACpB;AACAhD,QAAAA,QAAQ,GAAC;AACLc,UAAAA,MAAM,EAACH,MAAM,CAACJ,IAAP,CAAYO,MADd;AAELN,UAAAA,QAAQ,EAACG,MAAM,CAACJ,IAAP,CAAYC,QAFhB;AAGLO,UAAAA,UAAU,EAACJ,MAAM,CAACJ,IAAP,CAAYQ,UAHlB;AAILC,UAAAA,YAAY,EAACL,MAAM,CAACJ,IAAP,CAAYS,YAJpB;AAKLC,UAAAA,WAAW,EAACN,MAAM,CAACJ,IAAP,CAAYU,WALnB;AAMLC,UAAAA,gBAAgB,EAACP,MAAM,CAACJ,IAAP,CAAYW,gBANxB;AAOLC,UAAAA,YAAY,EAACR,MAAM,CAACJ,IAAP,CAAYY;AAPpB,SAAT;AASA,YAAIZ,IAAI,GAAGI,MAAM,CAACJ,IAAlB;AACA,YAAIe,IAAI,GAAGD,QAAQ,CAAC,SAAD,EAAWd,IAAX,CAAnB;AACAR,QAAAA,CAAC,CAAC,WAAD,CAAD,CAAeuB,IAAf,CAAoBA,IAApB,EAboB,CAepB;;AACA,YAAIC,OAAO,GAAGC,GAAG,CAAC,aAAD,CAAjB;AACAD,QAAAA,OAAO,CAACE,MAAR,CAAe;AACXC,UAAAA,QAAQ,EAAC;AADE,SAAf;AAIH,OArBD,MAqBK;AACDC,QAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAmBjB,MAAnB;AACH;AACJ,KA9BH;AAiCH,GA9HO,CAgIV;;;AACA,WAASF,MAAT,CAAgB0C,IAAhB,EAAsB;AAClB,QAAIC,GAAG,GAAG,IAAIC,MAAJ,CAAW,UAAUF,IAAV,GAAiB,eAA5B,EAA6C,GAA7C,CAAV;AACA,QAAIG,CAAC,GAAGC,MAAM,CAACnB,QAAP,CAAgBoB,MAAhB,CAAuBC,MAAvB,CAA8B,CAA9B,EAAiCC,KAAjC,CAAuCN,GAAvC,CAAR;AACA,QAAIE,CAAC,IAAI,IAAT,EAAe,OAAOK,SAAS,CAACL,CAAC,CAAC,CAAD,CAAF,CAAhB;AACf,WAAO,IAAP;AACH;AAGJ,CAzIA,CAAD","sourcesContent":["\r\n\r\n$(function () {\r\n    let GoodsObj={};\r\n    init()\r\n    function init(){\r\n      goodsDate() \r\n      eventList()\r\n    }\r\n   \r\n\r\n    function goodsDate() {\r\n        $.ajax({\r\n            type: \"get\",\r\n            url: \"http://api.pyg.ak48.xyz/api/public/v1/goods/detail\",\r\n            // datatype: 'json',\r\n            data:{goods_id:getUrl(\"goods_id\")},\r\n            success: function (result) {\r\n                if (result.meta.status == 200) {\r\n                    //商品信息\r\n                    GoodsObj={\r\n                        cat_id:result.data.cat_id,\r\n                        goods_id:result.data.goods_id,\r\n                        goods_name:result.data.goods_name,\r\n                        goods_number:result.data.goods_number,\r\n                        goods_price:result.data.goods_price,\r\n                        goods_small_logo:result.data.goods_small_logo,\r\n                        goods_weight:result.data.goods_weight\r\n                    };\r\n                    //需要的数据\r\n                    let data = result.data\r\n                    let htmls=template(\"main\",data)\r\n                    $(\".pyg_view\").html(htmls)\r\n\r\n\r\n                    // 轮播图的js 初始\r\n                    var gallery = mui(\".mui-slider\");\r\n                    gallery.slider({\r\n                        interval: 5000 //自动轮播周期，若为0则不自动播放，默认为0；\r\n                    });\r\n                } else {\r\n                    console.log('请求失败')\r\n                }\r\n\r\n\r\n            }\r\n        })\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n    function eventList() {\r\n        // 绑定 加入购物车 点击 事件\r\n        $(\".shoopping_car_btn\").on(\"tap\",function () {\r\n            let userStr = sessionStorage.getItem(\"userinfo\")\r\n            if(!userStr){\r\n          // 弹出 mui的消息提示框 自动消失\r\n            mui.toast(\"您还没有登录\");\r\n            setTimeout(()=>{\r\n                sessionStorage.setItem(\"pageurl\",location.href);\r\n                location.href=\"login.html\"\r\n            },1000)\r\n            }else{\r\n                let token = JSON.parse(userStr).token\r\n                $.ajax({\r\n                    url: \"http://api.pyg.ak48.xyz/api/public/v1/my/cart/add\",\r\n                    type:\"post\",\r\n                    data:{\r\n                        info:JSON.stringify(GoodsObj)\r\n                    },\r\n                    headers:{\r\n                        Authorization: token\r\n                    },\r\n                    success:function(result){\r\n                        if(result.meta.status==200){\r\n                            mui.confirm(\"您是否要跳转购物车网页\",\"添加成功\",[\"跳转\",\"取消\"],function(editType){\r\n                                if(editType.index==0){\r\n                                    location.href=\"cart.html\"\r\n                                }else if(editType==1){\r\n                                    console.log('取消')\r\n                                }\r\n                            })\r\n                        }else{\r\n                            mui.toast(result.meta.msg)\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n        \r\n        })\r\n        \r\n      }\r\n      function goodsDatail(){\r\n          $.get(\r\n            \"http://api.pyg.ak48.xyz/api/public/v1/goods/detail\",\r\n            {\r\n                goods_id:getUrl(\"goods_id\")\r\n            },\r\n            function(result){\r\n                if(result.meta.msg==200){\r\n                    //给全局商品信息对象赋值\r\n                    GoodsObj={\r\n                        cat_id:result.data.cat_id,\r\n                        goods_id:result.data.goods_id,\r\n                        goods_name:result.data.goods_name,\r\n                        goods_number:result.data.goods_number,\r\n                        goods_price:result.data.goods_price,\r\n                        goods_small_logo:result.data.goods_small_logo,\r\n                        goods_weight:result.data.goods_weight\r\n                    };\r\n                    let data = result.data;\r\n                    let html = template(\"mainTpl\",data)\r\n                    $(\".pyg_view\").html(html)\r\n\r\n                    //轮播图js初始化\r\n                    var gallery = mui(\".mui-slider\")\r\n                    gallery.slider({\r\n                        interval:5000\r\n                    })\r\n\r\n                }else{\r\n                    console.log('请求失败',result)\r\n                }\r\n            }\r\n\r\n          )\r\n      }\r\n\r\n    // 获取url上的参数 的值\r\n    function getUrl(name) {\r\n        var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n        var r = window.location.search.substr(1).match(reg);\r\n        if (r != null) return decodeURI(r[2]);\r\n        return null;\r\n    }\r\n\r\n\r\n})"],"file":"goods_detail.js"}